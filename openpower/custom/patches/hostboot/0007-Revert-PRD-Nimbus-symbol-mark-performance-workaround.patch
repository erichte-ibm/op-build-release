From 03aa25c53316c98b95554f59b09e9e33b1f0a907 Mon Sep 17 00:00:00 2001
From: "Daniel M. Crowell" <dcrowell@us.ibm.com>
Date: Wed, 6 Feb 2019 13:26:06 -0600
Subject: [PATCH 1/2] Revert "PRD: Nimbus symbol mark performance workaround"

This reverts commit 7995cbcf6dc4168623e70969371f7209cd0fcedf.

Change-Id: Ia0330f03c6bcae1f6fd4827b7c686d81fad600a1
---
 .../diag/prdf/common/plat/mem/prdfMemMark.C   | 20 +------------------
 .../diag/prdf/common/plat/p9/p9_mca_regs.rule | 13 +-----------
 2 files changed, 2 insertions(+), 31 deletions(-)

diff --git a/src/usr/diag/prdf/common/plat/mem/prdfMemMark.C b/src/usr/diag/prdf/common/plat/mem/prdfMemMark.C
index 8306a284a..078ac6abb 100644
--- a/src/usr/diag/prdf/common/plat/mem/prdfMemMark.C
+++ b/src/usr/diag/prdf/common/plat/mem/prdfMemMark.C
@@ -5,7 +5,7 @@
 /*                                                                        */
 /* OpenPOWER HostBoot Project                                             */
 /*                                                                        */
-/* Contributors Listed Below - COPYRIGHT 2016,2019                        */
+/* Contributors Listed Below - COPYRIGHT 2016,2017                        */
 /* [+] International Business Machines Corp.                              */
 /*                                                                        */
 /*                                                                        */
@@ -286,24 +286,6 @@ uint32_t writeSymbolMark<TYPE_MCA>( ExtensibleChip * i_chip,
                   msName, i_chip->getHuid() );
     }
 
-    // Nimbus symbol mark performance workaround
-    // When a symbol mark is placed at runtime
-    #ifdef __HOSTBOOT_RUNTIME
-
-    // Trigger WAT logic to 'disable bypass'
-    // Get the ECC Debug/WAT Control register
-    SCAN_COMM_REGISTER_CLASS * dbgr = i_chip->getRegister( "DBGR" );
-
-    // Set DBGR[8] = 0b1
-    dbgr->SetBit( 8 );
-    o_rc = dbgr->Write();
-    if ( SUCCESS != o_rc )
-    {
-        PRDF_ERR( PRDF_FUNC "Write() failed on DBGR: mca=0x%08x",
-                  i_chip->getHuid() );
-    }
-    #endif
-
     return o_rc;
 
     #undef PRDF_FUNC
diff --git a/src/usr/diag/prdf/common/plat/p9/p9_mca_regs.rule b/src/usr/diag/prdf/common/plat/p9/p9_mca_regs.rule
index 575bbbbb5..3db7276f4 100644
--- a/src/usr/diag/prdf/common/plat/p9/p9_mca_regs.rule
+++ b/src/usr/diag/prdf/common/plat/p9/p9_mca_regs.rule
@@ -5,7 +5,7 @@
 #
 # OpenPOWER HostBoot Project
 #
-# Contributors Listed Below - COPYRIGHT 2016,2019
+# Contributors Listed Below - COPYRIGHT 2016,2018
 # [+] International Business Machines Corp.
 #
 #
@@ -242,14 +242,3 @@
         capture     group default;
     };
 
-    ############################################################################
-    # ECC Debug/WAT Control Register
-    ############################################################################
-
-    register DBGR
-    {
-        name        "ECC Debug/WAT Control Register";
-        scomaddr    0x07010A0B;
-        capture     group default;
-    };
-
-- 
2.20.1.windows.1

